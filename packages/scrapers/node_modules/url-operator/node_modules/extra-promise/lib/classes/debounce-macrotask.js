import { setImmediate } from 'extra-timers';
export class DebounceMacrotask {
    constructor() {
        this.registry = new Set();
        this.tick = () => {
            const registry = this.registry;
            delete this.cancelMacrotask;
            this.registry = new Set();
            for (const fn of registry) {
                fn();
            }
        };
    }
    queue(fn) {
        this.registry.add(fn);
        if (!this.cancelMacrotask) {
            this.cancelMacrotask = setImmediate(this.tick);
        }
    }
    cancel(fn) {
        this.registry.delete(fn);
    }
}
//# sourceMappingURL=debounce-macrotask.js.map