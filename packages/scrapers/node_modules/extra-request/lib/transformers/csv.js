import { Headers } from 'extra-fetch';
import papaparse from 'papaparse';
import { assert } from '@blackglory/prelude';
const { unparse } = papaparse;
export function csv(payload) {
    assert(payload.length > 0, 'payload must be a non-empty array');
    return (options) => {
        const headers = new Headers(options.headers);
        headers.set('Content-Type', 'text/csv');
        return {
            ...options,
            headers,
            payload: stringify(payload)
        };
    };
}
function stringify(data) {
    const fields = Object.keys(data[0]);
    return unparse({ data, fields });
}
//# sourceMappingURL=csv.js.map