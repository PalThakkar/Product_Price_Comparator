"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setDynamicTimeoutLoop = void 0;
const set_timeout_1 = require("./set-timeout");
function setDynamicTimeoutLoop(timeout, cb) {
    let isCancelled = false;
    let cancel = (0, set_timeout_1.setTimeout)(timeout, loop);
    return () => {
        isCancelled = true;
        cancel();
    };
    async function loop() {
        const start = Date.now();
        await cb();
        const elapsed = Date.now() - start;
        if (!isCancelled) {
            cancel = (0, set_timeout_1.setTimeout)(Math.max(timeout - elapsed, 0), loop);
        }
    }
}
exports.setDynamicTimeoutLoop = setDynamicTimeoutLoop;
//# sourceMappingURL=set-dynamic-timeout-loop.js.map