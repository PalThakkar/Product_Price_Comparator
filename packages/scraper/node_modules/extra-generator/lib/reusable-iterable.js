import { lazy } from '@blackglory/prelude';
export class ReusableIterable {
    constructor(iterable) {
        this.getIterator = lazy(() => iterable[Symbol.iterator]());
    }
    get done() {
        return this._done;
    }
    close() {
        var _a, _b;
        if (!this._done) {
            this._done = true;
            (_b = (_a = this.getIterator()).return) === null || _b === void 0 ? void 0 : _b.call(_a);
        }
    }
    [Symbol.iterator]() {
        return {
            next: () => {
                if (this._done)
                    return { done: true, value: undefined };
                const { value, done } = this.getIterator().next();
                if (done) {
                    this._done = true;
                }
                return { value, done };
            }
        };
    }
}
//# sourceMappingURL=reusable-iterable.js.map