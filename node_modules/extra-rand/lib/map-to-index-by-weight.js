"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.mapToIndexByWeight = void 0;
const map_to_range_1 = require("./map-to-range");
const map_to_int_range_1 = require("./map-to-int-range");
function mapToIndexByWeight(value, oldMin, oldMax, weights) {
    const newMin = 0;
    const newMax = weights.reduce((acc, cur) => acc + Math.max(cur, 0));
    if (newMax === 0) {
        const index = (0, map_to_int_range_1.mapToIntRange)(value, oldMin, oldMax, newMin, weights.length);
        return index === weights.length
            ? weights.length - 1
            : index;
    }
    else {
        const newValue = (0, map_to_range_1.mapToRange)(value, oldMin, oldMax, newMin, newMax);
        let remains = newMax;
        for (let i = weights.length; i--;) {
            const weight = weights[i];
            if (weight <= 0) {
                continue;
            }
            else {
                remains -= weight;
                if (newValue >= remains) {
                    return i;
                }
            }
        }
        throw new Error('Impossible route');
    }
}
exports.mapToIndexByWeight = mapToIndexByWeight;
//# sourceMappingURL=map-to-index-by-weight.js.map