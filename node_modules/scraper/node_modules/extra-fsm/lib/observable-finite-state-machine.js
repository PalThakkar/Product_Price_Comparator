import { FiniteStateMachine } from './finite-state-machine.js';
import { Subject } from 'rxjs';
import { isEmptyObject } from 'extra-utils';
export class ObservableFiniteStateMachine extends FiniteStateMachine {
    constructor() {
        super(...arguments);
        this.stateChanges = new Subject();
    }
    get [Symbol.toStringTag]() {
        return this.constructor.name;
    }
    observeStateChanges() {
        return this.stateChanges;
    }
    send(event) {
        const oldState = this.state;
        super.send(event);
        const newState = this.state;
        this.stateChanges.next({ event, oldState, newState });
        if (isEmptyObject(this.schema[newState])) {
            this.stateChanges.complete();
        }
    }
}
//# sourceMappingURL=observable-finite-state-machine.js.map